parameters:
- name: 'websiteName' 
  type: string
- name: 'packageName' 
  type: string
  
steps:

- task: ExtractFiles@1
  displayName: 'Extract File'
  inputs:
    archiveFilePatterns: '$(Pipeline.Workspace)/drop${{parameters.packageName}}'
    destinationFolder: ${{variables.serviceBasePath}}
    cleanDestinationFolder: true
    overwriteExistingFiles: false   

- task: FileTransform@1
  inputs:
    folderPath: '$(Pipeline.Workspace)/drop${{parameters.packageName}}'
    enableXmlTransform: true
    xmlTransformationRules: '-transform **\web.Local.config -xml **\web.config'
        
- task: IISWebAppDeploymentOnMachineGroup@0
  displayName: ${{ parameters.websiteName }}
  inputs:
    WebSiteName: ${{ parameters.websiteName }}
    Package: '$(Pipeline.Workspace)/drop/${{parameters.packageName}}' 
    RemoveAdditionalFilesFlag: true
    TakeAppOfflineFlag: true
#    XmlTransformation: true

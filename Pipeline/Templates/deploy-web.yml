parameters:
- name: 'websiteName' 
  type: string
- name: 'packageName' 
  type: string
  
steps:

# https://github.com/microsoft/azure-pipelines-tasks/issues/11322

- task: FileTransform@1
  inputs:
    folderPath: '$(Pipeline.Workspace)/drop/${{parameters.packageName}}'
    enableXmlTransform: true
    xmlTransformationRules: '-transform **\*.Local.config -xml **\*.config'
        
- task: IISWebAppDeploymentOnMachineGroup@0
  displayName: ${{ parameters.websiteName }}
  inputs:
    WebSiteName: ${{ parameters.websiteName }}
    Package: '$(Pipeline.Workspace)/drop/${{parameters.packageName}}' 
    RemoveAdditionalFilesFlag: true
    TakeAppOfflineFlag: true

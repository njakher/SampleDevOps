parameters:
- name: 'project' 
  type: string
- name: 'packageName' 
  type: string

steps:

  - task: MSBuild@1
    inputs:
        solution: '${{parameters.project}}'
        msbuildArguments: '/p:DeployOnBuild=True /p:DeployDefaultTarget=WebPublish /p:WebPublishMethod=FileSystem /p:publishUrl=$(Build.ArtifactStagingDirectory)\${{parameters.packageName}}'
        platform: '$(buildPlatform)'
        configuration: '$(buildConfiguration)'

  - task: ArchiveFiles@2
    inputs:
        rootFolderOrFile: '$(Build.ArtifactStagingDirectory)\${{parameters.packageName}}'
        includeRootFolder: true
        archiveType: 'zip'
        archiveFile: '$(Build.ArtifactStagingDirectory)\package\${{parameters.packageName}}.zip'
        replaceExistingArchive: true
      
